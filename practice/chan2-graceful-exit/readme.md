# 使用 chan 实现程序的 graceful shutdown

doCleanup 可能是一个很耗时的操作，比如十几分钟才能完成，如果程序退出需要等待这么长时间，用户是不能接受的，所以，在实践中，我们需要设置一个最长的等待时间。只要超过了这个时间，程序就不再等待，可以直接退出。所以，退出的时候分为两个阶段：
```
closing，代表程序退出，但是清理工作还没做；
closed，代表清理工作已经做完。
``` 




